# Система управления с ПИД-регулятором и моделями объектов

## Summary

| Members | Descriptions |
|---------|--------------|
| `double linearModel(double y, double u, double a, double b)` | Линейная модель объекта управления первого порядка. |
| `double nonlinearModel(double y, double u, double y_prev, double u_prev, double a, double b, double c, double d)` | Нелинейная модель объекта управления с квадратичной и синусоидальной нелинейностями. |
| `std::vector<double> simulateLinearModel(double y, double u, int t, double a, double b)` | Выполняет симуляцию линейной модели на заданном временном интервале. |
| `std::vector<double> simulateNonLinearModel(double y, double u, int t, double a, double b, double c, double d)` | Выполняет симуляцию нелинейной модели на заданном временном интервале. |
| `class PIDController` | Класс ПИД-регулятора с анти-windup защитой и ограничениями сигналов. |
| `double PIDController::calculate(double setpoint, double measured_value)` | Вычисляет управляющее воздействие на основе текущей ошибки. |

## Функции моделирования

### `double linearModel(double y, double u, double a, double b)`

Линейная модель объекта управления первого порядка вида `y_next = a*y + b*u`.

**Parameters:**
- `y` - текущее значение выхода объекта (состояние системы)
- `u` - текущее значение управления (входной сигнал)
- `a` - коэффициент при предыдущем значении выхода
- `b` - коэффициент при входном воздействии

**Returns:**
следующее значение выхода объекта

### `double nonlinearModel(double y, double u, double y_prev, double u_prev, double a, double b, double c, double d)`

Нелинейная модель объекта управления с квадратичной и синусоидальной нелинейностями вида `y_next = a*y - b*y_prev^2 + c*u + d*sin(u_prev)`.

**Parameters:**
- `y` - текущее значение выхода объекта
- `u` - текущее значение управления
- `y_prev` - предыдущее значение выхода объекта (используется для квадратичной нелинейности)
- `u_prev` - предыдущее значение управления (используется для синусоидальной нелинейности)
- `a` - линейный коэффициент при текущем выходе
- `b` - коэффициент при квадрате предыдущего выхода (нелинейность)
- `c` - линейный коэффициент при управлении
- `d` - коэффициент при синусоидальном члене

**Returns:**
следующее значение выхода объекта

### `std::vector<double> simulateLinearModel(double y, double u, int t, double a, double b)`

Выполняет симуляцию линейной модели на заданном количестве шагов.

**Parameters:**
- `y` - начальное значение выхода объекта
- `u` - постоянное входное воздействие
- `t` - количество шагов симуляции
- `a` - коэффициент при предыдущем значении выхода
- `b` - коэффициент при входном воздействии

**Returns:**
вектор значений выхода объекта на каждом шаге симуляции

### `std::vector<double> simulateNonLinearModel(double y, double u, int t, double a, double b, double c, double d)`

Выполняет симуляцию нелинейной модели на заданном количестве шагов с внутренней логикой обновления предыдущих значений.

**Parameters:**
- `y` - начальное значение выхода объекта
- `u` - начальное значение управления
- `t` - количество шагов симуляции
- `a` - линейный коэффициент при текущем выходе
- `b` - коэффициент при квадрате предыдущего выхода
- `c` - линейный коэффициент при управлении
- `d` - коэффициент при синусоидальном члене

**Returns:**
вектор значений выхода объекта на каждом шаге симуляции

## Класс ПИД-регулятора

### `class PIDController`

Класс реализует дискретный ПИД-регулятор с защитой от windup и ограничениями сигналов.

**Конструктор:**
```cpp
PIDController(double kp, double ki, double kd, 
              double min_out = -1.0, double max_out = 1.0,
              double min_int = -10.0, double max_int = 10.0,
              double step_time = 1.0);
```

**Параметры конструктора:**
- `kp` - пропорциональный коэффициент
- `ki` - интегральный коэффициент
- `kd` - дифференциальный коэффициент
- `min_out` - минимальное значение выходного сигнала
- `max_out` - максимальное значение выходного сигнала
- `min_int` - минимальное значение интегральной суммы
- `max_int` - максимальное значение интегральной суммы
- `step_time` - время дискретизации (шаг регулирования)

### `double PIDController::calculate(double setpoint, double measured_value)`

Вычисляет управляющее воздействие на основе заданного значения и текущего измерения.

**Parameters:**
- `setpoint` - заданное значение (уставка)
- `measured_value` - измеренное текущее значение

**Returns:**
управляющее воздействие, ограниченное в диапазоне `[min_out, max_out]`

**Алгоритм работы:**
1. Вычисление ошибки: `error = setpoint - measured_value`
2. Пропорциональная составляющая: `P = Kp * error`
3. Интегральная составляющая: `integral += error * dt` с ограничением
4. Дифференциальная составляющая: `D = Kd * (error - prev_error) / dt`
5. Суммирование: `output = P + Ki*integral + D`
6. Ограничение выходного сигнала

### `void PIDController::reset()`

Сбрасывает внутреннее состояние регулятора (интегральную сумму и предыдущую ошибку).

### `void PIDController::setParameters(double kp, double ki, double kd)`

Устанавливает новые коэффициенты регулятора.

**Parameters:**
- `kp` - новый пропорциональный коэффициент
- `ki` - новый интегральный коэффициент
- `kd` - новый дифференциальный коэффициент

### `void PIDController::setOutputLimits(double min, double max)`

Устанавливает ограничения выходного сигнала.

**Parameters:**
- `min` - минимальное значение выходного сигнала
- `max` - максимальное значение выходного сигнала

### `void PIDController::setIntegralLimits(double min, double max)`

Устанавливает ограничения интегральной суммы (анти-windup защита).

**Parameters:**
- `min` - минимальное значение интегральной суммы
- `max` - максимальное значение интегральной суммы

## Демонстрационные функции

### `void demonstrateLinearPIDControl(double setpoint, int simulation_time, PIDController& pid)`

Демонстрирует работу ПИД-регулятора с линейной моделью объекта.

**Parameters:**
- `setpoint` - заданное значение для регулирования
- `simulation_time` - время симуляции в шагах
- `pid` - ссылка на объект ПИД-регулятора

### `void demonstrateNonLinearPIDControl(double setpoint, int simulation_time, PIDController& pid)`

Демонстрирует работу ПИД-регулятора с нелинейной моделью объекта.

**Parameters:**
- `setpoint` - заданное значение для регулирования
- `simulation_time` - время симуляции в шагах
- `pid` - ссылка на объект ПИД-регулятора