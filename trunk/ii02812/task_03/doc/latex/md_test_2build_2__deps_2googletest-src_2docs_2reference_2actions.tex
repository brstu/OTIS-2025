\chapter{Actions Reference }
\hypertarget{md_test_2build_2__deps_2googletest-src_2docs_2reference_2actions}{}\label{md_test_2build_2__deps_2googletest-src_2docs_2reference_2actions}\index{Actions Reference@{Actions Reference}}
\label{md_test_2build_2__deps_2googletest-src_2docs_2reference_2actions_autotoc_md243}%
\Hypertarget{md_test_2build_2__deps_2googletest-src_2docs_2reference_2actions_autotoc_md243}%


\href{../gmock_for_dummies.md\#actions-what-should-it-do}{\texttt{{\bfseries{Actions}}}} specify what a mock function should do when invoked. This page lists the built-\/in actions provided by Google\+Test. All actions are defined in the {\ttfamily \+::testing} namespace.\hypertarget{md_test_2build_2__deps_2googletest-src_2docs_2reference_2actions_autotoc_md244}{}\doxysection{\texorpdfstring{Returning a Value}{Returning a Value}}\label{md_test_2build_2__deps_2googletest-src_2docs_2reference_2actions_autotoc_md244}

\begin{DoxyTable}{2}{}{}{1}
\SetCell{bg=\tableheadbgcolor,font=\bfseries}\doxylink{class_action}{Action}  &\SetCell{bg=\tableheadbgcolor,font=\bfseries}Description  \\
{\ttfamily Return()}  &Return from a {\ttfamily void} mock function.  \\
{\ttfamily Return(value)}  &Return {\ttfamily value}. If the type of {\ttfamily value} is different to the mock function\textquotesingle{}s return type, {\ttfamily value} is converted to the latter type {\itshape at the time the expectation is set}, not when the action is executed.  \\
{\ttfamily Return\+Arg\texorpdfstring{$<$}{<}N\texorpdfstring{$>$}{>}()}  &Return the {\ttfamily N}-\/th (0-\/based) argument.  \\
{\ttfamily Return\+New\texorpdfstring{$<$}{<}T\texorpdfstring{$>$}{>}(a1, ..., ak)}  &Return {\ttfamily new T(a1, ..., ak)}; a different object is created each time.  \\
{\ttfamily Return\+Null()}  &Return a null pointer.  \\
{\ttfamily Return\+Pointee(ptr)}  &Return the value pointed to by {\ttfamily ptr}.  \\
{\ttfamily Return\+Ref(variable)}  &Return a reference to {\ttfamily variable}.  \\
{\ttfamily Return\+Ref\+Of\+Copy(value)}  &Return a reference to a copy of {\ttfamily value}; the copy lives as long as the action.  \\
{\ttfamily Return\+Round\+Robin(\{a1, ..., ak\})}  &Each call will return the next {\ttfamily ai} in the list, starting at the beginning when the end of the list is reached.  \\
\end{DoxyTable}
\hypertarget{md_test_2build_2__deps_2googletest-src_2docs_2reference_2actions_autotoc_md245}{}\doxysection{\texorpdfstring{Side Effects}{Side Effects}}\label{md_test_2build_2__deps_2googletest-src_2docs_2reference_2actions_autotoc_md245}

\begin{DoxyTable}{2}{}{}{1}
\SetCell{bg=\tableheadbgcolor,font=\bfseries}\doxylink{class_action}{Action}  &\SetCell{bg=\tableheadbgcolor,font=\bfseries}Description  \\
{\ttfamily Assign(\&variable, value)}  &Assign {\ttfamily value} to variable.  \\
{\ttfamily Delete\+Arg\texorpdfstring{$<$}{<}N\texorpdfstring{$>$}{>}()}  &Delete the {\ttfamily N}-\/th (0-\/based) argument, which must be a pointer.  \\
{\ttfamily Save\+Arg\texorpdfstring{$<$}{<}N\texorpdfstring{$>$}{>}(pointer)}  &Save the {\ttfamily N}-\/th (0-\/based) argument to {\ttfamily \texorpdfstring{$\ast$}{*}pointer}.  \\
{\ttfamily Save\+Arg\+Pointee\texorpdfstring{$<$}{<}N\texorpdfstring{$>$}{>}(pointer)}  &Save the value pointed to by the {\ttfamily N}-\/th (0-\/based) argument to {\ttfamily \texorpdfstring{$\ast$}{*}pointer}.  \\
{\ttfamily Set\+Arg\+Referee\texorpdfstring{$<$}{<}N\texorpdfstring{$>$}{>}(value)}  &Assign {\ttfamily value} to the variable referenced by the {\ttfamily N}-\/th (0-\/based) argument.  \\
{\ttfamily Set\+Arg\+Pointee\texorpdfstring{$<$}{<}N\texorpdfstring{$>$}{>}(value)}  &Assign {\ttfamily value} to the variable pointed by the {\ttfamily N}-\/th (0-\/based) argument.  \\
{\ttfamily Set\+Argument\+Pointee\texorpdfstring{$<$}{<}N\texorpdfstring{$>$}{>}(value)}  &Same as {\ttfamily Set\+Arg\+Pointee\texorpdfstring{$<$}{<}N\texorpdfstring{$>$}{>}(value)}. Deprecated. Will be removed in v1.\+7.\+0.  \\
{\ttfamily Set\+Array\+Argument\texorpdfstring{$<$}{<}N\texorpdfstring{$>$}{>}(first, last)}  &Copies the elements in source range \mbox{[}{\ttfamily first}, {\ttfamily last}) to the array pointed to by the {\ttfamily N}-\/th (0-\/based) argument, which can be either a pointer or an iterator. The action does not take ownership of the elements in the source range.  \\
{\ttfamily Set\+Errno\+And\+Return(error, value)}  &Set {\ttfamily errno} to {\ttfamily error} and return {\ttfamily value}.  \\
{\ttfamily Throw(exception)}  &Throws the given exception, which can be any copyable value. Available since v1.\+1.\+0.  \\
\end{DoxyTable}
\hypertarget{md_test_2build_2__deps_2googletest-src_2docs_2reference_2actions_autotoc_md246}{}\doxysection{\texorpdfstring{Using a Function, Functor, or Lambda as an Action}{Using a Function, Functor, or Lambda as an Action}}\label{md_test_2build_2__deps_2googletest-src_2docs_2reference_2actions_autotoc_md246}
In the following, by "{}callable"{} we mean a free function, {\ttfamily std\+::function}, functor, or lambda.


\begin{DoxyTable}{2}{}{}{1}
\SetCell{bg=\tableheadbgcolor,font=\bfseries}\doxylink{class_action}{Action}  &\SetCell{bg=\tableheadbgcolor,font=\bfseries}Description  \\
{\ttfamily f}  &Invoke {\ttfamily f} with the arguments passed to the mock function, where {\ttfamily f} is a callable.  \\
{\ttfamily Invoke(f)}  &Invoke {\ttfamily f} with the arguments passed to the mock function, where {\ttfamily f} can be a global/static function or a functor.  \\
{\ttfamily Invoke(object\+\_\+pointer, \&class\+::method)}  &Invoke the method on the object with the arguments passed to the mock function.  \\
{\ttfamily Invoke\+Without\+Args(f)}  &Invoke {\ttfamily f}, which can be a global/static function or a functor. {\ttfamily f} must take no arguments.  \\
{\ttfamily Invoke\+Without\+Args(object\+\_\+pointer, \&class\+::method)}  &Invoke the method on the object, which takes no arguments.  \\
{\ttfamily Invoke\+Argument\texorpdfstring{$<$}{<}N\texorpdfstring{$>$}{>}(arg1, arg2, ..., argk)}  &Invoke the mock function\textquotesingle{}s {\ttfamily N}-\/th (0-\/based) argument, which must be a function or a functor, with the {\ttfamily k} arguments.  \\
\end{DoxyTable}


The return value of the invoked function is used as the return value of the action.

When defining a callable to be used with {\ttfamily Invoke\texorpdfstring{$\ast$}{*}()}, you can declare any unused parameters as {\ttfamily Unused}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{using\ }::testing::Invoke;}
\DoxyCodeLine{\textcolor{keywordtype}{double}\ Distance(Unused,\ \textcolor{keywordtype}{double}\ x,\ \textcolor{keywordtype}{double}\ y)\ \{\ \textcolor{keywordflow}{return}\ sqrt(x*x\ +\ y*y);\ \}}
\DoxyCodeLine{...}
\DoxyCodeLine{EXPECT\_CALL(mock,\ Foo(\textcolor{stringliteral}{"{}Hi"{}},\ \_,\ \_)).WillOnce(Invoke(Distance));}

\end{DoxyCode}


{\ttfamily Invoke(callback)} and {\ttfamily Invoke\+Without\+Args(callback)} take ownership of {\ttfamily callback}, which must be permanent. The type of {\ttfamily callback} must be a base callback type instead of a derived one, e.\+g.


\begin{DoxyCode}{0}
\DoxyCodeLine{BlockingClosure*\ done\ =\ \textcolor{keyword}{new}\ BlockingClosure;}
\DoxyCodeLine{...\ Invoke(done)\ ...;\ \ \textcolor{comment}{//\ This\ won't\ compile!}}
\DoxyCodeLine{}
\DoxyCodeLine{Closure*\ done2\ =\ \textcolor{keyword}{new}\ BlockingClosure;}
\DoxyCodeLine{...\ Invoke(done2)\ ...;\ \ \textcolor{comment}{//\ This\ works.}}

\end{DoxyCode}


In {\ttfamily Invoke\+Argument\texorpdfstring{$<$}{<}N\texorpdfstring{$>$}{>}(...)}, if an argument needs to be passed by reference, wrap it inside {\ttfamily std\+::ref()}. For example,


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{using\ }::testing::InvokeArgument;}
\DoxyCodeLine{...}
\DoxyCodeLine{InvokeArgument<2>(5,\ string(\textcolor{stringliteral}{"{}Hi"{}}),\ std::ref(foo))}

\end{DoxyCode}


calls the mock function\textquotesingle{}s \#2 argument, passing to it {\ttfamily 5} and {\ttfamily string("{}Hi"{})} by value, and {\ttfamily foo} by reference.\hypertarget{md_test_2build_2__deps_2googletest-src_2docs_2reference_2actions_autotoc_md247}{}\doxysection{\texorpdfstring{Default Action}{Default Action}}\label{md_test_2build_2__deps_2googletest-src_2docs_2reference_2actions_autotoc_md247}

\begin{DoxyTable}{2}{}{}{1}
\SetCell{bg=\tableheadbgcolor,font=\bfseries}\doxylink{class_action}{Action}  &\SetCell{bg=\tableheadbgcolor,font=\bfseries}Description  \\
{\ttfamily Do\+Default()}  &Do the default action (specified by {\ttfamily ON\+\_\+\+CALL()} or the built-\/in one).  \\
\end{DoxyTable}


\{\+: .callout .note\} {\bfseries{Note\+:}} due to technical reasons, {\ttfamily Do\+Default()} cannot be used inside a composite action -\/ trying to do so will result in a run-\/time error.\hypertarget{md_test_2build_2__deps_2googletest-src_2docs_2reference_2actions_autotoc_md248}{}\doxysection{\texorpdfstring{Composite Actions}{Composite Actions}}\label{md_test_2build_2__deps_2googletest-src_2docs_2reference_2actions_autotoc_md248}

\begin{DoxyTable}{2}{}{}{1}
\SetCell{bg=\tableheadbgcolor,font=\bfseries}\doxylink{class_action}{Action}  &\SetCell{bg=\tableheadbgcolor,font=\bfseries}Description  \\
{\ttfamily Do\+All(a1, a2, ..., an)}  &Do all actions {\ttfamily a1} to {\ttfamily an} and return the result of {\ttfamily an} in each invocation. The first {\ttfamily n -\/ 1} sub-\/actions must return void and will receive a readonly view of the arguments.  \\
{\ttfamily Ignore\+Result(a)}  &Perform action {\ttfamily a} and ignore its result. {\ttfamily a} must not return void.  \\
{\ttfamily With\+Arg\texorpdfstring{$<$}{<}N\texorpdfstring{$>$}{>}(a)}  &Pass the {\ttfamily N}-\/th (0-\/based) argument of the mock function to action {\ttfamily a} and perform it.  \\
{\ttfamily With\+Args\texorpdfstring{$<$}{<}N1, N2, ..., Nk\texorpdfstring{$>$}{>}(a)}  &Pass the selected (0-\/based) arguments of the mock function to action {\ttfamily a} and perform it.  \\
{\ttfamily Without\+Args(a)}  &Perform action {\ttfamily a} without any arguments.  \\
\end{DoxyTable}
\hypertarget{md_test_2build_2__deps_2googletest-src_2docs_2reference_2actions_autotoc_md249}{}\doxysection{\texorpdfstring{Defining Actions}{Defining Actions}}\label{md_test_2build_2__deps_2googletest-src_2docs_2reference_2actions_autotoc_md249}

\begin{DoxyTable}{2}{}{}{1}
\SetCell{bg=\tableheadbgcolor,font=\bfseries}Macro  &\SetCell{bg=\tableheadbgcolor,font=\bfseries}Description  \\
{\ttfamily ACTION(\+Sum) \{ return arg0 + arg1; \}}  &Defines an action {\ttfamily Sum()} to return the sum of the mock function\textquotesingle{}s argument \#0 and \#1.  \\
{\ttfamily ACTION\+\_\+\+P(\+Plus, n) \{ return arg0 + n; \}}  &Defines an action {\ttfamily Plus(n)} to return the sum of the mock function\textquotesingle{}s argument \#0 and {\ttfamily n}.  \\
{\ttfamily ACTION\+\_\+\+Pk(\+Foo, p1, ..., pk) \{ statements; \}}  &Defines a parameterized action {\ttfamily Foo(p1, ..., pk)} to execute the given {\ttfamily statements}.  \\
\end{DoxyTable}


The {\ttfamily ACTION\texorpdfstring{$\ast$}{*}} macros cannot be used inside a function or class. 