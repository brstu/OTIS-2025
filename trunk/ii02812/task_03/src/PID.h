/**
 * @file PID.h
<<<<<<< HEAD
 * @brief «‡„ÓÎÓ‚Ó˜Ì˚È Ù‡ÈÎ ÍÎ‡ÒÒ‡ ‰ËÒÍÂÚÌÓ„Ó PID-Â„ÛÎˇÚÓ‡.
=======
 * @brief –ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª –∫–ª–∞—Å—Å–∞ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ PID-—Ä–µ–≥—É–ª—è—Ç–æ—Ä–∞.
>>>>>>> 235f543de1e891ea0b5921e2b58d0728432e8324
 *
 * –î–∞–Ω–Ω—ã–π PID —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ—Ä–º–µ –ø—Ä–∏—Ä–∞—â–µ–Ω–∏–π:
 * \f[
 *     \Delta u = q_0 e(k) + q_1 e(k-1) + q_2 e(k-2)
 * \f]
 * –≥–¥–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã q0, q1, q2 –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã K, T, T0, Td.
 */
#ifndef PID_H
#define PID_H

 /**
  * @class PID
  * @brief –ö–ª–∞—Å—Å –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ PID-—Ä–µ–≥—É–ª—è—Ç–æ—Ä–∞.
  *
  * –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –æ—à–∏–±–∫–∞–º–∏ —Ç–µ–∫—É—â–µ–≥–æ —à–∞–≥–∞,
  * –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∏ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ.
  */
class PID {
private:
	double K;   ///< –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —É—Å–∏–ª–µ–Ω–∏—è.
	double T;   ///< –í—Ä–µ–º—è –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∏—è.
	double T0;  ///< –ü–µ—Ä–∏–æ–¥ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏.
	double Td;  ///< –í—Ä–µ–º—è –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∞–Ω–∏—è.
	
	double q0;  ///< –î–∏—Å–∫—Ä–µ—Ç–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç q0.
	double q1;  ///< –î–∏—Å–∫—Ä–µ—Ç–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç q1.
	double q2;  ///< –î–∏—Å–∫—Ä–µ—Ç–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç q2.

<<<<<<< HEAD
	double u_prev = 0.0;   ///< œÂ‰˚‰Û˘ÂÂ ÁÌ‡˜ÂÌËÂ ÛÔ‡‚Îˇ˛˘Â„Ó ‚ÓÁ‰ÂÈÒÚ‚Ëˇ.
	double e_prev_1 = 0.0; ///< Œ¯Ë·Í‡ ÔÂ‰˚‰Û˘Â„Ó ¯‡„‡.
	double e_prev_2 = 0.0; ///< Œ¯Ë·Í‡ ¯‡„‡ k-2.
	bool valid = false;    ///< ‘Î‡„ ÍÓÂÍÚÌÓÒÚË ÒÓÒÚÓˇÌËˇ.
=======
	double u_prev = 0.0;   ///< –ü—Ä–µ–¥—ã–¥—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —É–ø—Ä–∞–≤–ª—è—é—â–µ–≥–æ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è.
	double e_prev_1 = 0.0; ///< –û—à–∏–±–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞.
	double e_prev_2 = 0.0; ///< –û—à–∏–±–∫–∞ —à–∞–≥–∞ k-2.
	bool valid = false;    ///< –§–ª–∞–≥ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è.
>>>>>>> 235f543de1e891ea0b5921e2b58d0728432e8324


public:

	/**
	 * @brief –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä PID-—Ä–µ–≥—É–ª—è—Ç–æ—Ä–∞.
	 *
	 * @param in_K –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —É—Å–∏–ª–µ–Ω–∏—è.
	 * @param in_T –ü–µ—Ä–∏–æ–¥ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∏—è.
	 * @param in_Td –í—Ä–µ–º—è –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∞–Ω–∏—è.
	 * @param in_T0 –ü–µ—Ä–∏–æ–¥ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏.
	 */
	PID(double in_K, double in_T, double in_T0, double in_Td);

	/**
	 * @brief –í—ã—á–∏—Å–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—é—â–µ–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ –ø–æ —Ç–µ–∫—É—â–µ–π –æ—à–∏–±–∫–µ.
	 *
	 * @param e –û—à–∏–±–∫–∞ —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è.
	 * @return –ù–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —É–ø—Ä–∞–≤–ª—è—é—â–µ–≥–æ —Å–∏–≥–Ω–∞–ª–∞.
	 */
	double u_calc(double e);

	/**
	 * @brief –î–µ–ª–∞–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏ (–¥–ª—è —Ç–µ—Å—Ç–æ–≤).
	 */
	void invalidate() { valid = false; }

	/**
	 * @brief –î–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä.
	 */
	~PID() = default;
};

#endif // PID_H
